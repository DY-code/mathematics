# 第1章 控制系统的状态空间表达式

## 状态变量及状态空间表达式

- 状态变量
- 状态矢量
- 状态空间
- 状态方程
- 输出方程
- 状态空间表达式
  - 单输入-单输出系统
    - 矢量矩阵：
$
\begin{cases}
\dot{x} = Ax + bu \\
y = cx + du
\end{cases}
$
  - 多输入-多输出系统
    - 矢量矩阵：
$
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx + Du
\end{cases}
$
- 状态空间表达式的系统框图



## 状态变量及状态空间表达式的模拟结构图

### 框图绘制步骤 

1. 积分器的数量 = 状态变量数，每个积分器的输出表示一个状态变量
2. 根据状态方程和输出方程，画出加法器和比例器
3. 用箭头连接元件


## 状态变量及状态空间表达式的建立（一）

### 由系统框图建立状态空间表达式

1. 将系统的各个环节，变成相应的模拟结构图
2. 把每个积分器的输出选为一个状态变量$x_i$，其输入为$\dot{x}_i$
3. 由模拟图直接写出系统的状态方程和输出方程

### 由系统机理建立状态空间表达式

- 由系统的物理规律，建立其状态方程

## 状态变量及状态空间表达式的建立（二）

- 实现问题：由描述系统输入-输出动态关系的运动方程式或传递函数，建立系统的状态空间表达式。
- 实现的非唯一性：从传递函数求得的状态空间表达式不是唯一的



- 考虑单变量线性定常系统：
$
y^{(n)} + a_{n - 1}y^{(n - 1)} + ... + a_1\dot{y} + a_0y \\
= b_mu^{(m)} + b_{m - 1}u^{(m - 1)} + ... + b_1\dot{u} + b_0u
$
传递函数：
$
W(s) = \frac{Y(s)}{U(s)} = \frac{b_ms^m + b_{m - 1}s^{m - 1} + ... + b_1s + b_0}{s^n + a_{n - 1}s^{n - 1} + ... + a_1s + a_0}, \\
m \le n
$

- 传递函数中没有
零点时的实现
    - $
\begin{pmatrix}
\dot{x}_1 \\
\dot{x}_2 \\
\vdots \\
\dot{x}_{n - 1} \\
\dot{x}_n
\end{pmatrix} = 
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 \\
0 & 0 & 1 & \dots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \dots & 1 \\
-a_0 & -a_1 & -a_2 & \dots & -a_{n -1}
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_{n - 1} \\
x_n
\end{pmatrix} + 
\begin{pmatrix}
0 \\
0 \\
\vdots \\
0 \\
1
\end{pmatrix}u \\
y = 
\begin{pmatrix}
b_0 & 0 & 0 & \dots & 0
\end{pmatrix}x
$
  - 友矩阵

- 传递函数中有
零点时的实现
  - 实现方法1
    - $
\begin{pmatrix}
\dot{x}_1 \\
\dot{x}_2 \\
\vdots \\
\dot{x}_{n - 1} \\
\dot{x}_n
\end{pmatrix} = 
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 \\
0 & 0 & 1 & \dots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \dots & 1 \\
-a_0 & -a_1 & -a_2 & \dots & -a_{n -1}
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_{n - 1} \\
x_n
\end{pmatrix} + 
\begin{pmatrix}
0 \\
0 \\
\vdots \\
0 \\
1
\end{pmatrix}u\\
y = ((b_0 - a_0b_n),\ (b_1 - a_1b_n),\ ...,\ (b_{n - 1} - a_{n - 1}b_n))
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_{n - 1} \\
x_n
\end{pmatrix} + b_nu
$

  - 实现方法2（等效思想）
    - $
\begin{bmatrix}
\dot{x}_1 \\
\dot{x}_2 \\
\vdots \\
\dot{x}_{n - 1} \\
\dot{x}_n
\end{bmatrix} = 
\begin{bmatrix}
0 & 1 & 0 & \dots & 0 \\
0 & 0 & 1 & \dots & 0 \\
\vdots & \vdots & \vdots & \dots & \vdots \\
0 & 0 & 0 & \dots & 1 \\
-a_0 & -a_1 & -a_2 & \dots & -a_{n -1}
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
\vdots \\
x_{n - 1} \\
x_{n} \\
\end{bmatrix} + 
\begin{bmatrix}
\beta_{n - 1} \\
\beta_{n - 2} \\
\vdots \\
\beta_{1} \\
\beta_{0} \\
\end{bmatrix}u \\
y = 
\begin{bmatrix}
1 & 0 & 0 & \dots & 0 \\
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
\vdots \\
x_{n - 1} \\
x_{n} \\
\end{bmatrix} + 
\beta_n u \\
\begin{bmatrix} 
1 \\
a_{n - 1} & 1 \\
a_{n - 2} & a_{n - 1} & 1 \\
\vdots & \vdots & \ddots & \ddots \\
a_0 & a_1 & \dots & a_{n - 1} & 1 \\
\end{bmatrix}
\begin{bmatrix}
\beta_{n} \\
\beta_{n - 1} \\
\beta_{n - 2} \\
\vdots \\
\beta_{0} \\
\end{bmatrix} = 
\begin{bmatrix}
b_{n} \\
b_{n - 1} \\
b_{n - 2} \\
\vdots \\
b_{0} \\
\end{bmatrix}
$

- 多输入-多输出系统微分方程的实现
  - 积分-模拟结构图法

## 状态矢量的线性变换（坐标变换）

### 系统状态空间表达式的非唯一性

1. 系统可以有多种结构形式
2. 通过矢量的线性变换（坐标变换）可以得到多组状态变量

- $
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx + Du
\end{cases}
\Rightarrow 
\begin{cases}
\dot{z} = T^{-1}ATz + T^{-1}Bu \\
y = CTz + Du
\end{cases}
(x = Tz,T为非奇异矩阵)
$

### 系统特征值的不变性及系统的不变量

- 系统特征值：
$|\lambda I - A| = 0$的根
- 系统的不变量（特征多项式的系数）
特征值的不变性
- 特征矢量-$
Ap_i = \lambda_ip_i
$

### 状态空间表达式变换为约旦标准形

- $
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx
\end{cases}
\Rightarrow
\begin{cases}
\dot{z} = Jz + T^{-1}Bu \\
y = CTz
\end{cases}
(J = T^{-1}AT)
$

- 约旦标准型矩阵
  - 无重根：对角线型
$
J = T^{-1}AT \\
= \begin{bmatrix}
\lambda_1 & 0 & \dots & 0 \\
0 & \lambda_2 & \dots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & \lambda_n
\end{bmatrix}
$
  - 有重根($q$个重根$\lambda_1$)：约旦块型
$
J = \begin{bmatrix}
\lambda_1 & 0 & \dots & 0 \\
0 & \lambda_1 & \dots & 0 & & 0\\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & \lambda_1 \\
& & & & \lambda_{q + 1} & 0 & 0 \\
& 0 & & & 0 & \ddots & 0 \\
& & & & 0 & 0 & \lambda_{n} \\
\end{bmatrix}
$

- 变换矩阵T的求法
  - A的特征值无重根
    1. 求A的n个互异特征根$\lambda_i$
    2. 求$\lambda_i$的特征矢量$P_i$
    3. $T = (P_1, P_2, \dots, P_n)$
  - A的特征值有重根
    - 对应于q个$\lambda_1$重根的各向量$P_1, \dots, P_q$的求法：
$
\begin{cases}
\lambda_{1}P_1 - AP_1 = 0 \\
\lambda_1P_2 - AP_2 = -P_1 \\
\dots \\
\lambda_1P_q - AP_q = -P_{q - 1}
\end{cases}
$
$P_2, \dots, P_q$称为**广义特征矢量**

## 从状态空间表达式求传递函数阵

### 传递函数（阵）

- 单输入-单输出系统
$
\begin{cases}
\dot{x} = Ax + bu \\
y = cx + du
\end{cases}
$
  - 输入-状态：$
W_{ux}(s) = \frac{X(s)}{U(s)} = (sI - A)^{-1}b
$
  - 输入-输出：$
W(s) = \frac{Y(s)}{U(s)} = c(sI - A)^{-1}b + d
$ ==记忆==

- 多输入-多输出系统（传递函数阵）
$
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx + Du
\end{cases}
$
  - 输入-状态：$
W_{ux}(s) = \frac{X(s)}{U(s)} = (sI - A)^{-1}B
$

  - 输入-输出：$
W(s) = \frac{Y(s)}{U(s)} = C(sI - A)^{-1}B + D = \begin{bmatrix}
W_{ij}(s)
\end{bmatrix}
$
$W_{ij}(s)$：第j个输入对第i个输出的传递关系
  - 同一系统，状态空间表达式不唯一，但**传递函数阵不变**

### 子系统在各种连接时的传递函数阵

- 并联：$
W(s) = W_1(s) \pm W_2(s)
$

- 串联：$
W(s) = W_2(s) \cdot W_1(s)
$（注意先后次序）

- 反馈
  - $
W(s) = W_1(s)[I + W_2(s)W_1(s)]^{-1} \\
= [I + W_1(s)W_2(s)]^{-1}W_1(s)
$