# 线性控制系统的能控性和能观性

## 能控性的定义

### 能控性的含义

1. 系统在输入$u(t)$的控制下，状态$x(t)$的转移情况
2. 与系统输出$y(t)$无关
3. 只与系统的状态方程有关

### 概念区分

- 状态的能控性
- 系统状态完全能控
  - 系统的所有状态都能控

### 状态的能达性

- 对于线性定常系统有：
能控性 $\Harr$ 能达性
能控系统 $\Harr$ 能达系统

## 线性定常系统能控性判别

### 具有约旦标准形系统的能控性判别

#### A为对角线矩阵

- 单输入/多输入系统：
若B的任一行不为0，则系统完全能控

#### A为约旦块

- 单输入/多输入系统：
若约旦块对应的B末尾行非全0，则系统能控

#### A为普通矩阵的处理方法

- 线性变换不改变系统的能控性
$
\dot{x} = Ax + Bu \\
\Downarrow x = Tz \\
\dot{z} = Jz + T^{-1}Bu
$

### 直接从A与B判别系统的能控性（秩判据）

#### 单输入系统

- 单输入系统：$
\dot{x} = Ax + bu
$
能控性矩阵：$
M = [b \quad Ab \quad A^2b \quad ... A^{n - 1}b]
$
能控充要条件：能控性矩阵M满秩，即$rankM = n$

#### 多输入系统

- 多输入系统：$
\dot{x} = Ax + Bu
$
能控性矩阵：$
M = [B \quad AB \quad A^2B \quad ... A^{n - 1}B]
$
能控充要条件：能控性矩阵M满秩，即$rankM = n$

- 注意：对于多输入系统，不一定需要计算出全部M阵

## 线性连续定常系统能观性

### 能观性定义

#### 直观理解

1. 系统的状态矢量$x(t)$能否通过输出$y(t)$反映
2. 与控制作用没有直接关系
3. 只需研究齐次状态方程和输出方程：
$
\begin{cases}
\dot{x}(t) = Ax(t) \\
y(t) = Cx(t)
\end{cases}
$

#### 概念区分

- 状态变量的能观
- 系统状态完全能观
  - 若系统每一个状态都能观测，则系统状态完全能观测

### 线性定常系统能观性判别

#### 具有约旦标准型系统的能观性判别

- A为对角线矩阵：
若输出矩阵C任一列不为0，则系统完全能观
- A为约旦块矩阵：
若输出矩阵C对应每个约旦块开头一列非全零，则系统能观

#### 直接从A，C阵判断系统的能观性（秩判据）

- 系统：$
\begin{cases}
\dot{x} = Ax,\ x(t_0) = x_0 \\
y = Cx
\end{cases}
$
能观性矩阵：$
N_{nm \times n} = [C \quad CA \quad ... CA^{n - 1}]^T
$
完全能观的充要条件：能观性矩阵N的秩为n

## 能控性与能观性的对偶关系

### 线性系统的对偶关系

- $
\Sigma_1:
\begin{cases}
\dot{x}_1 = A_1x_1 + B_{1, n \times r}u_{1, r} \\
y_{1, m} = C_{1, m \times n}x_1
\end{cases} \\
\Sigma_2:
\begin{cases}
\dot{x}_2 = A_2x_2 + B_{2, n \times m}u_{2, m} \\
y_{2, r} = C_{2, r \times n}x_2
\end{cases}
$
$\Sigma_1, \Sigma_2$互为对偶的条件：
$
A_2 = A_1^T,\ B_2 = C_1^T,\ C_2 = B_1^T
$

- 对偶系统的传递函数矩阵互为转置：
$\Sigma_1$输入-状态 $\Harr$ $\Sigma_2$初始状态-输出
- 互为对偶的系统，其特征方程式相同：
$
| sI - A_1 | = | sI - A_2 |
$

### 对偶原理

- 若系统$\Sigma_1, \Sigma_2$互为对偶，则有：
$\Sigma_1$完全能控 $\Harr$ $\Sigma_2$完全能观

## 状态空间表达式的能控标准型与能观标准型

### 状态空间表达式的3种标准形式

- 约旦标准型
- 能控标准型
- 能观标准型

### 单输入系统的能控标准型

#### 能控标准$I$型

- $
\begin{cases}
\dot{x} = Ax + bu \\
y = cx
\end{cases}
\stackrel{x = T_{c1}\overline{x}}{===\Rightarrow}
\begin{cases}
\dot{\overline{x}} = \overline{A}\overline{x} + \overline{b}\overline{u} \\
y = \overline{c}\overline{x} 
\end{cases} \\
特征方程：|\lambda I - A| = \lambda^n + a_{n - 1}\lambda^{n - 1} + ... + a_1\lambda + a_0 = 0 \\
T_{c1} = 
[A^{n - 1}b \quad A^{n - 2}b \quad ... \quad b]
\begin{bmatrix}
1 & & & & 0 \\
a_{n - 1} & 1 \\
\vdots & & \ddots \\
a_2 & a_3 & & \ddots \\
a_1 & a_2 & \dots & a_{n - 1} & 1
\end{bmatrix} \\
\overline{A} = T_{c1}^{-1}AT_{c1} = 
\begin{bmatrix}
0 & 1 & 0 & \dots & 0 \\
0 & 0 & 1 & \dots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \dots & 1 \\
-a_0 & -a_1 & -a_2 & \dots & -a_{n - 1}
\end{bmatrix} \\
\overline{b} = [0 \quad 0 \quad ... \quad 1]^T \\
\overline{c} = cT_{c1}
$

#### 能控标准$II$型

- $
\begin{cases}
\dot{x} = Ax + bu \\
y = cx
\end{cases}
\stackrel{T_{c2} = [b \quad Ab \quad ... \quad A^{n - 1}b]}{===========\Rightarrow}
\begin{cases}
\dot{\overline{x}} = \overline{A}\overline{x} + \overline{b}\overline{u} \\
y = \overline{c}\overline{x} 
\end{cases} \\
\overline{A} = T_{c2}^{-1}AT_{c2} = 
\begin{bmatrix}
0 & 0 & \dots & 0 & -a_0 \\
1 & 0 & \dots & 0 & -a_1 \\
0 & 1 & \dots & 0 & -a_2 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \dots & 1 & -a_{n - 1} \\
\end{bmatrix} \\
\overline{b} = [1 \quad 0 \quad \dots \quad 0 \quad 0]^T \\
\overline{c} = cT_{c2} = 
[cb \quad cAb \quad \dots \quad cA^{n - 1}b]
$

### 单输出系统的能观标准型

#### 能观标准$I$型

- 与能控标准$II$型对偶

- $
\begin{cases}
\dot{x} = Ax + bu \\
y = cx
\end{cases} 
\stackrel{T_{01}^{-1} = N = [c \quad cA \quad \dots \quad cA^{n - 1}]^T}{==============\Rightarrow}
\begin{cases}
\dot{\tilde{x}} = \tilde{A}\tilde{x} + \tilde{b}u \\
y = \tilde{c}\tilde{x}
\end{cases} \\
\tilde{A} = T_{01}^{-1}AT_{01} = 
\begin{bmatrix}
0 & 1 & \dots & 0 & 0 \\
0 & 0 & \ddots & 0 & 0 \\
\vdots & \vdots & \ddots & \ddots & \vdots \\
0 & 1 & \dots & 0 & 1 \\
-a_0 & -a_1 & \dots & -a_{n - 2} & -a_{n - 1}
\end{bmatrix} \\
\tilde{b} = T_{01}^{-1}b = [cb \quad cAb \quad \dots \quad cA^{n - 1}b]^T \\
\tilde{c} = cT_{01} = [1 \quad 0 \quad 0 \quad ... \quad 0]
$

#### 能观标准$II$型

- 与能控标准$I$型对偶

- $
\begin{cases}
\dot{x} = Ax + bu \\
y = cx
\end{cases}
\stackrel{x = T_{02}\tilde{x}}{====\Rightarrow}
\begin{cases}
\dot{\tilde{x}} = \tilde{A}\tilde{x} + \tilde{b}u \\
y = \tilde{c}\tilde{x}
\end{cases} \\
T_{02}^{-1} = 
\begin{bmatrix}
1 & a_{n - 1} & \dots & a_2 & a_1 \\
0 & 1 & \dots & a_3 & a_2 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \dots & 1 & a_{n - 1} \\
0 & 0 & \dots & 0 & 1
\end{bmatrix}
\begin{bmatrix}
CA^{n - 1} \\
\vdots \\
CA \\
C
\end{bmatrix} \\
\tilde{A} = T_{02}^{-1}AT_{02} = 
\begin{bmatrix}
0 & 0 & \dots & 0 & -a_0 \\
1 & 0 & \dots & 0 & -a_1 \\
0 & 1 & \dots & 0 & -a_2 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \dots & 1 & -a_{n - 1} 
\end{bmatrix} \\
\tilde{b} = T_{02}^{-1}b \\
\tilde{c} = cT_{02} = [0 \quad 0 \quad 0 \quad \dots \quad 1]
$

## 线性系统的结构分解

- 能控子空间：包含状态空间中的所有能控状态
- 能观子空间：包含状态空间中的所有能观状态

### 按能控性分解

- $
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx
\end{cases}
\stackrel{x = R_c\hat{x}}{===\Rightarrow}
\begin{cases}
\dot{\hat{x}} = \hat{A}\hat{x} + \hat{B}u \\
y = \hat{C}\hat{x}
\end{cases} \\
\hat{x} = 
\begin{bmatrix}
\hat{x}_1 \\ 
\hat{x}_2
\end{bmatrix} \\
\hat{A} = R_c^{-1}AR_c = 
\begin{bmatrix}
\hat{A}_{11} & \hat{A}_{12} \\
0 & \hat{A}_{22}
\end{bmatrix} \\
\hat{B} = R_c^{-1}B = 
\begin{bmatrix}
B_1 \\
0
\end{bmatrix} \\
\hat{C} = CR_c = [\hat{C}_1 \quad \hat{C}_2]
$

- 状态空间的分解
  - 能控：$
\dot{\hat{x}}_1 = \hat{A}_{11}\hat{x}_1 + \hat{A}_{12}\hat{x}_2 + \hat{B}_1u 
$
  - 不能控：$
\dot{\hat{x}}_2 = \hat{A}_{22}\hat{x}_2 
$

- 非奇异变换阵$R_c$的获取
  - 前$n_1$个列矢量是能控性矩阵M中$n_1$个线性无关的列
  - 其他列在确保$R_c$是非奇异的条件下任意选取

- 按能控性分解的步骤
  1. 判断能控性
  2. 确定变换矩阵
  3. 套公式计算
  4. 提取子系统 

### 按能观性分解

- $
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx
\end{cases}
\stackrel{x = R_o\tilde{x}}{===\Rightarrow}
\begin{cases}
\dot{\tilde{x}} = \tilde{A}\tilde{x} + \tilde{B}u \\
y = \tilde{C}\tilde{x}
\end{cases} \\
\tilde{A} = R_o^{-1}AR_o = 
\begin{bmatrix}
\tilde{A}_{11} & 0 \\
\tilde{A}_{21} & \tilde{A}_{22}
\end{bmatrix} \\
\tilde{B} = R_o^{-1}B = 
\begin{bmatrix}
\tilde{B}_1 \\
\tilde{B}_2
\end{bmatrix} \\
\tilde{C} = CR_o = 
\begin{bmatrix}
\tilde{C}_1 & 0
\end{bmatrix}
$

- 状态空间的分解
  - 能观：$
\begin{cases}
\dot{\tilde{x}}_1 = \tilde{A}_{11}\tilde{x}_1 + \tilde{B}_1u \\
y = \tilde{C}_1\tilde{x}_1 
\end{cases} 
$
  - 不能观：$
\dot{\tilde{x}}_2  = \tilde{A}_{21}\tilde{x}_1 + \tilde{A}_{22}\tilde{x}_2 + \tilde{B}_2u
$

- 非奇异变换阵$R_o^{-1}$的获取
  - 前$n_1$行矢量是能观性判别阵中$n_1$个线性无关的行
  - 其他行矢量在确保$R_o^{-1}$为非奇异的条件下任意选取

- 按能观性分解的步骤
  1. 判断能观性
  2. 确定变换矩阵
  3. 套公式计算
  4. 提取子系统

### 按能控性和能观性分解

- 状态空间的分解部分
  1. 能控且能观
  2. 能控不能观
  3. 不能控能观
  4. 不能控不能观

- 传递函数阵$W(s)$只能反映系统中能控且能观的子系统的动力学行为
  - 最小实现问题 

- 能控能观分解的步骤
  1. 判断能控性
  2. 按能控性分解
  3. 分别判断能控子系统和不能控子系统的能观性
  4. 分别按能观性分解
  5. 按四类状态变量分组，写出分解后系统

## 传递函数矩阵的实现问题

### 实现问题的基本概念

- 实现的定义：
给定传递函数阵$W(s)$，求一状态空间表达式$
\Sigma
\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx + Du
\end{cases}
$，
满足$
C(sI - A)^{-1}B + D = W(s)
$

### 能控标准形实现和能观标准形实现

### 最小实现

- 定义：$x$的维数最小的实现
- 定理：最小实现的充要条件
$\Sigma(A, B, C)$能控且能观
- 寻求最小实现的步骤