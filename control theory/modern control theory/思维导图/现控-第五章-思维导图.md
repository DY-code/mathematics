# 线性定常系统的综合

## 线性反馈控制系统的基本结构及其特性

### 状态反馈

- 状态线性反馈控制律：
$
u = Kx + v
$
$K$：状态反馈系数（增益）阵

- 闭环系统$
\Sigma_k = [(A + BK), B, C] = 
\begin{cases}
\dot{x} = (A + BK)x + Bv \\
y = Cx
\end{cases}
$

- 闭环系统的传递函数阵：
$
W_k(s) = C[sI - (A + BK)]^{-1}B
$

### 输出反馈

- 输出线性反馈控制律：
$
u = Hy + v
$
$H$：输出反馈增益阵

- 闭环系统$
\Sigma_H = [(A + HC), B, C] = 
\begin{cases}
\dot{x} = (A + BHC)x + Bv \\
y = Cx
\end{cases}
$

- 闭环系统的传递函数阵：
$
W_H(s) = C[sI - (A + BHC)]^{-1}B
$

- 说明
  1. 输出反馈中的$HC$与状态反馈中的$K$相当
  2. 输出反馈只能相当于一种部分状态反馈
  3. 当$C = I$时，$HC = K$，等同于全状态反馈

### 从输出到$\dot{x}$反馈

- 闭环系统$
\Sigma_G = [(A + GC), B, C] = 
\begin{cases}
\dot{x} = (A + GC)x + Bu \\
y = Cx
\end{cases}
$
$G$：反馈增益阵

- 闭环系统的传递函数阵：
$
W_G(s) = C[sI - (A + GC)]^{-1}B
$

### 闭环系统的能控性与能观性

- 状态反馈不改变能控性，能观性不确定
- 输出反馈不改变受控系统的能控性和能观性

## 极点配置问题

- 指定极点分布，设计反馈增益阵

### 采用状态反馈

- 采用状态反馈对系统$\Sigma_0(A, b, c)$任意配置极点的充要条件：
$\Sigma_0(A, b, c)$完全能控

- 步骤
  1. 引入状态反馈阵$K$，得闭环系统特征多项式：$
f(\lambda) = \det[\lambda I - (A + bk)]
$
  2. 由给定极点值得期望特征多项式：$
f^*(\lambda) = \prod_{i = 1}^n (\lambda - p_i)
$
  3. 比较$f(\lambda),\ f^*(\lambda)$对应各项系数，得$K$

### 采用输出反馈

- 对完全能控的单入单出系统，不能采用输出线性反馈实现闭环系统极点的任意配置

### 采用从输出到$\dot{x}$反馈

- 对系统$\Sigma_0(A, b, c)$采用从输出到$\dot{x}$的线性反馈实现闭环极点任意配置的充要条件：
$\Sigma_0(A, b, c)$完全能观

- $\lambda_{(A^T + c^TG^T)} = \lambda_{(A + Gc)}$
设计$\Sigma_0(A, b, c)$输出到$\dot{x}$反馈阵$G$ $\Harr$ 对偶系统$\tilde{\Sigma_0(A^T, c^T, b^T)}$设计状态反馈阵$K$

## 系统镇定问题

- 系统镇定：受控系统通过反馈使其极点均具有负实部，保证为渐进稳定
  - 状态反馈能镇定
  - 输出反馈能镇定

- 对系统$\Sigma_0(A, B, C)$，状态反馈能镇定的充要条件：
不能控子系统为渐进稳定
- 对系统$\Sigma_0(A, B, C)$，输出反馈能镇定的充要条件：
1、$\Sigma_0$结构分解中能控且能观子系统是输出反馈能镇定的
2、其余子系统渐进稳定
- 对系统$\Sigma_0(A, B, C)$，输出到$\dot{x}$反馈能镇定的充要条件：
$\Sigma_0$的不能观子系统为渐进稳定

## 状态观测器

- 利用输入量和输出量，借助状态观测器重构状态

### 状态观测器定义

- 动态系统$\hat{\Sigma}$以$\Sigma_0$的输入$u$和输出$y$作为输入量，输出量$\hat{x}$渐进于$x$，即$\lim_{t \rightarrow \infty}|x - \hat{x}| = 0$

### 状态观测器的存在性

- 对于线性定常系统，状态观测器存在的充要条件：
$\Sigma_0$的不能观子系统为渐进稳定

### 状态观测器的实现

- 状态观测方程：$
\dot{\hat{x}} = (A - GC)\hat{x} + Gy + Bu
$
$\hat{x}$：状态观测器的状态矢量，状态$x$估值
$G$：状态观测器的输出误差反馈矩阵

### 反馈矩阵G的设计

- 状态误差矢量：$\tilde{x} = x - \hat{x}$
$\Rightarrow \quad \dot{\tilde{x}} = (A - GC)\tilde{x}$

#### 设计步骤

1. 检验系统能观性，系统能观则可构造观测器
2. 将系统化为能观$II$型：$
\begin{cases}
\dot{\overline{x}} = T^{-1}AT\overline{x} + T^{-1}bu \\
y = cT\overline{x}
\end{cases}
$
3. 引入反馈阵$\overline{G} = 
\begin{bmatrix}
\overline{g}_1 \\
\overline{g}_2 \\
\end{bmatrix}
$，得观测器特征多项式：
$
f(\lambda) = \det[\lambda I - (\overline{A} - \overline{G}\overline{C})]
$
4. 由期望极点得期望特征式：
$
f^*(\lambda) = \prod_{i = 1}^n(\lambda - p_i)
$
5. 比较$f(\lambda),\ f^*(\lambda)$系数，得$\overline{G}$
6. 反变换到$x$状态下：$G = T\overline{G}$
7. 得观测器方程：
$
\dot{\hat{x}} = (A - Gc)\hat{x} + bu + Gy \\
或：\dot{\hat{x}} = A\hat{x} + bu + G(y - \hat{y})
$

- 注意：当系统维数较低时，检验能观性后，可直接按特征式比较来确定反馈阵$G$，无需化为能观标准型

#### 注意

- 当系统$(A, B, C)$不完全能观，但不能观子系统渐进稳定，则仍可构造状态观测，
此时$\hat{x}$趋近于$x$的速度将不能由$G$任意选择，而要受到不能观子系统极点位置的限制。

### 降维观测器

- 若系统能观，且输出矩阵$c$的秩是$m$ $\Rightarrow$
$m$个状态分量可由$y$直接获得
$(n - m)$个状态分量用$(n - m)$维的降维观测器进行重构

## 利用状态观测器实现状态反馈的系统

### 系统的结构与状态空间表达式

- $
\begin{cases}
\dot{x} = Ax + BK\hat{x} + Bv \\
\dot{\hat{x}} = GCx + (A - GC + BK)\hat{x} + Bv \\
y = Cx
\end{cases}
$

### 闭环系统的基本特性

- 闭环极点设计的分离性：
只要系统$(A, B, C)$能观，则系统的状态反馈阵$K$和观测器反馈阵$G$可分别进行设计
  - $\Sigma_k = (A + BK, B, C)$闭环极点：
1、$\Sigma_0$直接状态反馈系统的极点
2、观测器$\Sigma_G$的极点
二者独立，相互分离

- 传递函数矩阵的不变性
  - 1、用观测器构成的状态反馈系统
2、状态直接反馈系统
二者传递函数相同

- 观测器反馈与直接状态反馈的等效性
  - 当$t \rightarrow \infty$，进入稳态时，观测器反馈才与直接状态反馈等效
  - 可通过选择$G$来加速$\tilde{x} \rightarrow 0$，即$\hat{x}$渐进于$x$的速度

### 带观测器状态反馈系统与带补偿器输出反馈系统的等价性

- 就传递特性而言，带观测器的状态反馈系统完全等效于同时带有串联补偿器和反馈补偿器的输出反馈系统
- 用补偿器可以构成完全等效于观测器反馈的系统